[gd_scene load_steps=32 format=3 uid="uid://cjm5p2a8x7b1q"]

[ext_resource type="Script" uid="uid://dsy06xm0r81xn" path="res://scripts/missions/mission_2/Mission2.gd" id="1"]
[ext_resource type="Script" uid="uid://f3rodujd6g18" path="res://scripts/utils/graphs/visuals/GraphDisplay.gd" id="2"]
[ext_resource type="PackedScene" uid="uid://b7qv5xk8p3nt1" path="res://scenes/views/NodeView.tscn" id="3"]
[ext_resource type="PackedScene" uid="uid://c5h8lam2n4p6q" path="res://scenes/views/EdgeView.tscn" id="4"]
[ext_resource type="Script" uid="uid://fgm4ahof83xw" path="res://scripts/utils/graphs/editor/GraphBuilder.gd" id="5"]
[ext_resource type="Script" uid="uid://5x1d3j1l85ra" path="res://scripts/utils/graphs/editor/GraphNodeData.gd" id="6"]
[ext_resource type="Script" uid="uid://2whcwiw6slu" path="res://scripts/utils/graphs/editor/GraphConnectionData.gd" id="7"]
[ext_resource type="Script" uid="uid://dkmqha3s6mcs" path="res://scripts/missions/mission_1/NetworkNodeMeta.gd" id="8"]

[sub_resource type="Resource" id="NetworkNodeMeta_control"]
script = ExtResource("8")
hidden_message = "Centro de comando - punto de partida seguro."
device_type = "Control Center"
display_name = "Control Center"

[sub_resource type="Resource" id="GraphNodeData_control"]
script = ExtResource("6")
node_key = "Control Center"
vertex_meta = SubResource("NetworkNodeMeta_control")

[sub_resource type="Resource" id="NetworkNodeMeta_infected"]
script = ExtResource("8")
hidden_message = "Servidor infectado - objetivo de la misión."
is_root = true
threat_level = 3
device_type = "Infected Server"
display_name = "Infected Server"

[sub_resource type="Resource" id="GraphNodeData_infected"]
script = ExtResource("6")
node_key = "Infected Server"
vertex_meta = SubResource("NetworkNodeMeta_infected")

[sub_resource type="Resource" id="NetworkNodeMeta_router_a"]
script = ExtResource("8")
threat_level = 1
device_type = "Router"
display_name = "Router A"

[sub_resource type="Resource" id="GraphNodeData_router_a"]
script = ExtResource("6")
node_key = "Router A"
vertex_meta = SubResource("NetworkNodeMeta_router_a")

[sub_resource type="Resource" id="NetworkNodeMeta_router_b"]
script = ExtResource("8")
threat_level = 2
device_type = "Router"
display_name = "Router B"

[sub_resource type="Resource" id="GraphNodeData_router_b"]
script = ExtResource("6")
node_key = "Router B"
vertex_meta = SubResource("NetworkNodeMeta_router_b")

[sub_resource type="Resource" id="NetworkNodeMeta_switch"]
script = ExtResource("8")
threat_level = 1
device_type = "Switch"
display_name = "Switch Central"

[sub_resource type="Resource" id="GraphNodeData_switch"]
script = ExtResource("6")
node_key = "Switch Central"
vertex_meta = SubResource("NetworkNodeMeta_switch")

[sub_resource type="Resource" id="NetworkNodeMeta_firewall"]
script = ExtResource("8")
threat_level = 1
device_type = "Firewall"
display_name = "Firewall"

[sub_resource type="Resource" id="GraphNodeData_firewall"]
script = ExtResource("6")
node_key = "Firewall"
vertex_meta = SubResource("NetworkNodeMeta_firewall")

[sub_resource type="Resource" id="NetworkNodeMeta_proxy"]
script = ExtResource("8")
threat_level = 2
device_type = "Proxy"
display_name = "Proxy Server"

[sub_resource type="Resource" id="GraphNodeData_proxy"]
script = ExtResource("6")
node_key = "Proxy Server"
vertex_meta = SubResource("NetworkNodeMeta_proxy")

[sub_resource type="Resource" id="GraphConnectionData_1"]
script = ExtResource("7")
from_node = "Control Center"
to_node = "Router A"

[sub_resource type="Resource" id="GraphConnectionData_2"]
script = ExtResource("7")
from_node = "Control Center"
to_node = "Firewall"
weight = 2.0

[sub_resource type="Resource" id="GraphConnectionData_3"]
script = ExtResource("7")
from_node = "Router A"
to_node = "Switch Central"
weight = 1.5

[sub_resource type="Resource" id="GraphConnectionData_4"]
script = ExtResource("7")
from_node = "Router A"
to_node = "Router B"
weight = 4.0

[sub_resource type="Resource" id="GraphConnectionData_5"]
script = ExtResource("7")
from_node = "Firewall"
to_node = "Switch Central"
weight = 3.0

[sub_resource type="Resource" id="GraphConnectionData_6"]
script = ExtResource("7")
from_node = "Firewall"
to_node = "Proxy Server"
weight = 2.5

[sub_resource type="Resource" id="GraphConnectionData_7"]
script = ExtResource("7")
from_node = "Switch Central"
to_node = "Infected Server"

[sub_resource type="Resource" id="GraphConnectionData_8"]
script = ExtResource("7")
from_node = "Router B"
to_node = "Infected Server"
weight = 5.0

[sub_resource type="Resource" id="GraphConnectionData_9"]
script = ExtResource("7")
from_node = "Proxy Server"
to_node = "Infected Server"
weight = 6.0

[node name="Mission_2" type="Node2D"]
script = ExtResource("1")

[node name="GraphDisplay" type="Node2D" parent="."]
position = Vector2(576, 324)
script = ExtResource("2")
node_scene = ExtResource("3")
edge_scene = ExtResource("4")
layout_type = "circular"
edge_label_mode = "weight"
show_edge_direction = true

[node name="GraphBuilder" type="Node" parent="."]
script = ExtResource("5")
nodes = Array[ExtResource("6")]([SubResource("GraphNodeData_control"), SubResource("GraphNodeData_infected"), SubResource("GraphNodeData_router_a"), SubResource("GraphNodeData_router_b"), SubResource("GraphNodeData_switch"), SubResource("GraphNodeData_firewall"), SubResource("GraphNodeData_proxy")])
connections = Array[ExtResource("7")]([SubResource("GraphConnectionData_1"), SubResource("GraphConnectionData_2"), SubResource("GraphConnectionData_3"), SubResource("GraphConnectionData_4"), SubResource("GraphConnectionData_5"), SubResource("GraphConnectionData_6"), SubResource("GraphConnectionData_7"), SubResource("GraphConnectionData_8"), SubResource("GraphConnectionData_9")])

[node name="HUD" type="CanvasLayer" parent="."]

[node name="PanelContainer" type="PanelContainer" parent="HUD"]
anchors_preset = 6
anchor_left = 1.0
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
offset_left = -280.0
offset_top = -150.0
offset_bottom = 150.0
grow_horizontal = 0
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="HUD/PanelContainer"]
layout_mode = 2

[node name="TitleLabel" type="Label" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 20
text = "Misión 2: Camino Mínimo"
horizontal_alignment = 1

[node name="HSeparator" type="HSeparator" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="InstructionLabel" type="Label" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2
text = "Traza la ruta más segura desde
el Centro de Control hasta el
Servidor Infectado."
horizontal_alignment = 1

[node name="HSeparator2" type="HSeparator" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="ControlButtons" type="HBoxContainer" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="CalculateButton" type="Button" parent="HUD/PanelContainer/VBoxContainer/ControlButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Calcular Ruta"

[node name="StepButton" type="Button" parent="HUD/PanelContainer/VBoxContainer/ControlButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Paso"

[node name="HSeparator3" type="HSeparator" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="DistanceLabel" type="Label" parent="HUD/PanelContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Distancia acumulada: 0.0"
horizontal_alignment = 1

[node name="HSeparator4" type="HSeparator" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="StatusLabel" type="Label" parent="HUD/PanelContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Estado: Listo"
autowrap_mode = 2

[node name="HSeparator5" type="HSeparator" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="ResultLabel" type="RichTextLabel" parent="HUD/PanelContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 3
bbcode_enabled = true
text = "[center][b]Objetivo:[/b][/center]
Encuentra el camino con el menor costo total desde el Centro de Control hasta el Servidor Infectado."
fit_content = true

[node name="HSeparator6" type="HSeparator" parent="HUD/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="ContinueButton" type="Button" parent="HUD/PanelContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Continuar"
