[gd_scene load_steps=43 format=3 uid="uid://c0eh55ue0le5q"]

[ext_resource type="Script" uid="uid://cgkcu22neyt76" path="res://scripts/missions/mission_1/Mission1.gd" id="1"]
[ext_resource type="Script" uid="uid://f3rodujd6g18" path="res://scripts/utils/graphs/visuals/GraphDisplay.gd" id="2"]
[ext_resource type="PackedScene" uid="uid://b7qv5xk8p3nt1" path="res://scenes/views/NodeView.tscn" id="3"]
[ext_resource type="PackedScene" uid="uid://c5h8lam2n4p6q" path="res://scenes/views/EdgeView.tscn" id="4"]
[ext_resource type="Script" uid="uid://fgm4ahof83xw" path="res://scripts/utils/graphs/editor/GraphBuilder.gd" id="5_h74cb"]
[ext_resource type="Script" uid="uid://5x1d3j1l85ra" path="res://scripts/utils/graphs/editor/GraphNodeData.gd" id="6_t440f"]
[ext_resource type="Script" uid="uid://2whcwiw6slu" path="res://scripts/utils/graphs/editor/GraphConnectionData.gd" id="7_n2hvw"]
[ext_resource type="Script" uid="uid://dkmqha3s6mcs" path="res://scripts/missions/mission_1/NetworkNodeMeta.gd" id="7_t440f"]

[sub_resource type="Resource" id="NetworkNodeMeta_firewall"]
script = ExtResource("7_t440f")
hidden_message = "Registros sospechosos en horario nocturno."
threat_level = 1
device_type = "Firewall"
display_name = "Firewall Central"

[sub_resource type="Resource" id="GraphNodeData_firewall"]
script = ExtResource("6_t440f")
node_key = "Firewall Central"
vertex_meta = SubResource("NetworkNodeMeta_firewall")

[sub_resource type="Resource" id="NetworkNodeMeta_database"]
script = ExtResource("7_t440f")
hidden_message = "Acceso inusual desde una IP interna."
threat_level = 2
device_type = "Database"
display_name = "Base de Datos"

[sub_resource type="Resource" id="GraphNodeData_database"]
script = ExtResource("6_t440f")
node_key = "Base de Datos"
vertex_meta = SubResource("NetworkNodeMeta_database")

[sub_resource type="Resource" id="NetworkNodeMeta_mail"]
script = ExtResource("7_t440f")
hidden_message = "Correo con adjunto malicioso detectado."
threat_level = 2
display_name = "Servidor de Correo"

[sub_resource type="Resource" id="GraphNodeData_mail"]
script = ExtResource("6_t440f")
node_key = "Servidor de Correo"
vertex_meta = SubResource("NetworkNodeMeta_mail")

[sub_resource type="Resource" id="NetworkNodeMeta_proxy"]
script = ExtResource("7_t440f")
hidden_message = "Saltos extraños en la ruta."
threat_level = 1
device_type = "Proxy"
display_name = "Proxy"

[sub_resource type="Resource" id="GraphNodeData_proxy"]
script = ExtResource("6_t440f")
node_key = "Proxy"
vertex_meta = SubResource("NetworkNodeMeta_proxy")

[sub_resource type="Resource" id="NetworkNodeMeta_router"]
script = ExtResource("7_t440f")
hidden_message = "Este nodo contiene el proceso raíz del virus."
is_root = true
threat_level = 3
device_type = "Router"
display_name = "Router Core"

[sub_resource type="Resource" id="GraphNodeData_router"]
script = ExtResource("6_t440f")
node_key = "Router Core"
vertex_meta = SubResource("NetworkNodeMeta_router")

[sub_resource type="Resource" id="NetworkNodeMeta_ids"]
script = ExtResource("7_t440f")
hidden_message = "Sistema de detección: alertas por tráfico anómalo."
threat_level = 2
device_type = "IDS"
display_name = "IDS"

[sub_resource type="Resource" id="GraphNodeData_ids"]
script = ExtResource("6_t440f")
node_key = "IDS"
vertex_meta = SubResource("NetworkNodeMeta_ids")

[sub_resource type="Resource" id="NetworkNodeMeta_switch"]
script = ExtResource("7_t440f")
hidden_message = "Switch con puertos inconsistentes detectados."
threat_level = 1
device_type = "Switch"
display_name = "Core Switch"

[sub_resource type="Resource" id="GraphNodeData_switch"]
script = ExtResource("6_t440f")
node_key = "Core Switch"
vertex_meta = SubResource("NetworkNodeMeta_switch")

[sub_resource type="Resource" id="NetworkNodeMeta_dmz"]
script = ExtResource("7_t440f")
hidden_message = "Servidor en DMZ responde a pings sospechosos."
threat_level = 2
display_name = "DMZ Server"

[sub_resource type="Resource" id="GraphNodeData_dmz"]
script = ExtResource("6_t440f")
node_key = "DMZ Server"
vertex_meta = SubResource("NetworkNodeMeta_dmz")

[sub_resource type="Resource" id="NetworkNodeMeta_ws_a"]
script = ExtResource("7_t440f")
hidden_message = "Estación de trabajo A ejecutó procesos desconocidos."
threat_level = 1
device_type = "Workstation"
display_name = "Workstation A"

[sub_resource type="Resource" id="GraphNodeData_ws_a"]
script = ExtResource("6_t440f")
node_key = "Workstation A"
vertex_meta = SubResource("NetworkNodeMeta_ws_a")

[sub_resource type="Resource" id="NetworkNodeMeta_ws_b"]
script = ExtResource("7_t440f")
hidden_message = "Estación de trabajo B con conexiones a hosts externos."
threat_level = 1
device_type = "Workstation"
display_name = "Workstation B"

[sub_resource type="Resource" id="GraphNodeData_ws_b"]
script = ExtResource("6_t440f")
node_key = "Workstation B"
vertex_meta = SubResource("NetworkNodeMeta_ws_b")

[sub_resource type="Resource" id="NetworkNodeMeta_backup"]
script = ExtResource("7_t440f")
hidden_message = "Servidor de backup con archivos modificados recientemente."
threat_level = 2
device_type = "Backup"
display_name = "Backup Server"

[sub_resource type="Resource" id="GraphNodeData_backup"]
script = ExtResource("6_t440f")
node_key = "Backup Server"
vertex_meta = SubResource("NetworkNodeMeta_backup")

[sub_resource type="Resource" id="GraphConnectionData_1"]
script = ExtResource("7_n2hvw")
from_node = "Firewall Central"
to_node = "Proxy"

[sub_resource type="Resource" id="GraphConnectionData_3"]
script = ExtResource("7_n2hvw")
from_node = "Proxy"
to_node = "Servidor de Correo"

[sub_resource type="Resource" id="GraphConnectionData_4"]
script = ExtResource("7_n2hvw")
from_node = "Servidor de Correo"
to_node = "Base de Datos"

[sub_resource type="Resource" id="GraphConnectionData_5"]
script = ExtResource("7_n2hvw")
from_node = "Core Switch"
to_node = "Router Core"

[sub_resource type="Resource" id="GraphConnectionData_6"]
script = ExtResource("7_n2hvw")
from_node = "Core Switch"
to_node = "Firewall Central"

[sub_resource type="Resource" id="GraphConnectionData_7"]
script = ExtResource("7_n2hvw")
from_node = "Core Switch"
to_node = "DMZ Server"

[sub_resource type="Resource" id="GraphConnectionData_8"]
script = ExtResource("7_n2hvw")
from_node = "DMZ Server"
to_node = "Workstation A"

[sub_resource type="Resource" id="GraphConnectionData_9"]
script = ExtResource("7_n2hvw")
from_node = "Workstation A"
to_node = "Workstation B"

[sub_resource type="Resource" id="GraphConnectionData_10"]
script = ExtResource("7_n2hvw")
from_node = "Workstation B"
to_node = "Servidor de Correo"

[sub_resource type="Resource" id="GraphConnectionData_11"]
script = ExtResource("7_n2hvw")
from_node = "Backup Server"
to_node = "Base de Datos"

[sub_resource type="Resource" id="GraphConnectionData_12"]
script = ExtResource("7_n2hvw")
from_node = "Backup Server"
to_node = "Core Switch"

[sub_resource type="Resource" id="GraphConnectionData_2"]
script = ExtResource("7_n2hvw")
from_node = "Router Core"
to_node = "IDS"

[node name="Mission_1" type="Node2D"]
script = ExtResource("1")

[node name="GraphDisplay" type="Node2D" parent="."]
position = Vector2(576, 150)
script = ExtResource("2")
node_scene = ExtResource("3")
edge_scene = ExtResource("4")

[node name="GraphBuilder" type="Node" parent="."]
script = ExtResource("5_h74cb")
nodes = Array[ExtResource("6_t440f")]([SubResource("GraphNodeData_firewall"), SubResource("GraphNodeData_database"), SubResource("GraphNodeData_mail"), SubResource("GraphNodeData_proxy"), SubResource("GraphNodeData_router"), SubResource("GraphNodeData_ids"), SubResource("GraphNodeData_switch"), SubResource("GraphNodeData_dmz"), SubResource("GraphNodeData_ws_a"), SubResource("GraphNodeData_ws_b"), SubResource("GraphNodeData_backup")])
connections = Array[ExtResource("7_n2hvw")]([SubResource("GraphConnectionData_1"), SubResource("GraphConnectionData_3"), SubResource("GraphConnectionData_4"), SubResource("GraphConnectionData_5"), SubResource("GraphConnectionData_6"), SubResource("GraphConnectionData_7"), SubResource("GraphConnectionData_8"), SubResource("GraphConnectionData_9"), SubResource("GraphConnectionData_10"), SubResource("GraphConnectionData_11"), SubResource("GraphConnectionData_12"), SubResource("GraphConnectionData_2")])

[node name="HUD" type="CanvasLayer" parent="."]

[node name="Panel" type="Panel" parent="HUD"]
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_left = 16.0
offset_top = -136.5
offset_right = 273.0
offset_bottom = 136.5
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="HUD/Panel"]
layout_mode = 0
offset_right = 257.0
offset_bottom = 272.5

[node name="VBoxContainer" type="VBoxContainer" parent="HUD/Panel/MarginContainer"]
layout_mode = 2

[node name="TitleLabel" type="Label" parent="HUD/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 20
text = "Misión 1: Network Tracer"

[node name="HSeparator" type="HSeparator" parent="HUD/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="AlgorithmLabel" type="Label" parent="HUD/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Algoritmo de Búsqueda:"

[node name="AlgorithmButtons" type="HBoxContainer" parent="HUD/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="BFSButton" type="Button" parent="HUD/Panel/MarginContainer/VBoxContainer/AlgorithmButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "BFS"

[node name="DFSButton" type="Button" parent="HUD/Panel/MarginContainer/VBoxContainer/AlgorithmButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "DFS"

[node name="HSeparator2" type="HSeparator" parent="HUD/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="ControlButtons" type="HBoxContainer" parent="HUD/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="StartButton" type="Button" parent="HUD/Panel/MarginContainer/VBoxContainer/ControlButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Iniciar"

[node name="StepButton" type="Button" parent="HUD/Panel/MarginContainer/VBoxContainer/ControlButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Paso"

[node name="ContinueButton" type="Button" parent="HUD/Panel/MarginContainer/VBoxContainer/ControlButtons"]
unique_name_in_owner = true
visible = false
layout_mode = 2
size_flags_horizontal = 3
text = "Continuar"

[node name="HSeparator3" type="HSeparator" parent="HUD/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="StatusLabel" type="Label" parent="HUD/Panel/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Estado: Listo"

[node name="CluesLabel" type="Label" parent="HUD/Panel/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Pistas encontradas: 0"

[node name="ResultLabel" type="RichTextLabel" parent="HUD/Panel/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 3
bbcode_enabled = true
text = "[center][b]Resultado:[/b][/center]
Encuentra el nodo raíz infectado."
